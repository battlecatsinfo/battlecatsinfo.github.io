(()=>{"use strict";var t={n:i=>{var s=i&&i.t?()=>i.default:()=>i;return t.d(s,{a:s}),s},d:(i,s)=>{for(var h in s)t.i(s,h)&&!t.i(i,h)&&Object.defineProperty(i,h,{enumerable:!0,get:s[h]})},i:(t,i)=>Object.prototype.hasOwnProperty.call(t,i)};class i{static h=new i;o;canvas;l;position;u;m;p;g;v;matrix=new Float32Array(16);$;M;static _(t){let i=t.toString();switch(i.length){case 3:return i;case 2:return"0"+i;default:return"00"+i}}I(t,i,s,h,e,n){this.matrix[0]=2/(i-t),this.matrix[1]=0,this.matrix[2]=0,this.matrix[3]=0,this.matrix[4]=0,this.matrix[5]=2/(h-s),this.matrix[6]=0,this.matrix[7]=0,this.matrix[8]=0,this.matrix[9]=0,this.matrix[10]=2/(e-n),this.matrix[11]=0,this.matrix[12]=(t+i)/(t-i),this.matrix[13]=(s+h)/(s-h),this.matrix[14]=(e+n)/(e-n),this.matrix[15]=1}scale(t,i){this.matrix[0]*=t,this.matrix[1]*=t,this.matrix[2]*=t,this.matrix[3]*=t,this.matrix[4]*=i,this.matrix[5]*=i,this.matrix[6]*=i,this.matrix[7]*=i}translate(t,i){this.matrix[12]=this.matrix[0]*t+this.matrix[4]*i+this.matrix[8]+this.matrix[12],this.matrix[13]=this.matrix[1]*t+this.matrix[5]*i+this.matrix[9]+this.matrix[13],this.matrix[14]=this.matrix[2]*t+this.matrix[6]*i+this.matrix[10]+this.matrix[14],this.matrix[15]=this.matrix[3]*t+this.matrix[7]*i+this.matrix[11]+this.matrix[15]}}class s{static h=new s;P=new Float32Array(8);A;F;C;L=!1;R;S;B;G;T=0;W=0;k(){this.R=i.h.canvas.width,this.S=0,this.G=i.h.canvas.height,this.B=0,this.L=!0}D(){this.L=!1,this.R=Math.max(0,this.R-10),this.S=this.S+10,this.G=Math.max(0,this.G-10),this.B=this.B+10}U(t){switch(t){case 0:this.A=WebGL2RenderingContext.SRC_ALPHA,this.F=WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA;break;case 1:this.A=WebGL2RenderingContext.SRC_ALPHA,this.F=WebGL2RenderingContext.ONE;break;case 3:this.A=WebGL2RenderingContext.ZERO,this.F=WebGL2RenderingContext.SRC_COLOR;break;case 4:this.A=WebGL2RenderingContext.ONE_MINUS_DST_COLOR,this.F=WebGL2RenderingContext.ONE}}N(t){this.C=t}O(t,s,h,e,n,a,o,r,l,c,u,d,f){if(this.L)return this.R=Math.min(s,e,a,r,this.R),this.S=Math.max(s,e,a,r,this.S),this.G=Math.min(h,n,o,l,this.G),void(this.B=Math.max(h,n,o,l,this.B));const m=i.h.l;this.P[0]=s-this.T,this.P[1]=h-this.W,this.P[2]=e-this.T,this.P[3]=n-this.W,this.P[4]=r-this.T,this.P[5]=l-this.W,this.P[6]=a-this.T,this.P[7]=o-this.W,m.blendFunc(this.A,this.F),m.bindBuffer(m.ARRAY_BUFFER,i.h.u),m.bufferData(m.ARRAY_BUFFER,this.P,m.STATIC_DRAW),this.P[0]=c,this.P[1]=u,this.P[2]=c,this.P[3]=u+f,this.P[4]=c+d,this.P[5]=u,this.P[6]=c+d,this.P[7]=u+f;for(let i=0;i<8;)this.P[i++]/=t.X,this.P[i++]/=t.Y;m.bindBuffer(m.ARRAY_BUFFER,i.h.p),m.bufferData(m.ARRAY_BUFFER,this.P,m.STATIC_DRAW),m.bindTexture(m.TEXTURE_2D,t.q),m.drawArrays(m.TRIANGLE_STRIP,0,4)}H(){const t=i.h.l;t.clearColor(0,0,0,0),t.bindBuffer(t.ARRAY_BUFFER,i.h.u),t.vertexAttribPointer(i.h.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(i.h.position),t.bindBuffer(t.ARRAY_BUFFER,i.h.p),t.vertexAttribPointer(i.h.m,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(i.h.m),t.enable(t.BLEND),t.blendFuncSeparate(t.ONE_MINUS_SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE),t.blendEquation(t.FUNC_ADD),this.U(0)}setAlpha(t){i.h.l.vertexAttrib1f(i.h.g,t)}j(){const t=i.h.l;t.clear(t.COLOR_BUFFER_BIT)}}class h{x;y;width;height}class e{a;b;V=0;Z(t){return parseInt(this.b[t])}async K(t){const i=await fetch(t);if(!i.ok)throw"File not found";this.a=await i.text()}J(t){return this.b[t]}tt(){if(this.V>=this.a.length)return null;let t=this.V;if(this.V=this.a.indexOf("\n",t),-1==this.V)return this.V=this.a.length,this.a.slice(t);let i=this.a.slice(t,this.V++);return i.includes("\r")?i.replaceAll("\r",""):i}it(t=","){let i=this.tt();return i&&(this.b=i.split(t)),this.b}c(){return this.a}close(){}}class n{q;st;ht;X;Y;name;et;nt;async drawImage(t,s){let h=t.width;this.st=h;let e=t.height;this.ht=e;let n=1;for(;n<h;)n*=2;this.X=n;let a=1;for(;a<e;)a*=2;this.Y=a;const o=document.createElement("canvas"),r=o.getContext("2d");o.width=n,o.height=a,r.drawImage(t,0,0);const l=i.h.l;this.q=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.q),0!=(8&s)?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST)):(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR)),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,o)}async load(t,i,s=0){if(this.reset(),this.nt=s,null!=i)if(0!=(1&s)){let t=new e;await t.K(i),t.tt(),t.tt(),t.tt(),t.it();let s=t.Z(0);this.et=new Array(s);for(let i=0;i<s;i++)t.it(),this.et[i].x=t.Z(0),this.et[i].y=t.Z(1),this.et[i].width=t.Z(2),this.et[i].height=t.Z(3);t.close()}else{let t=new e;await t.K(i),t.tt(),t.tt(),t.tt(),t.it();let s=t.Z(0);this.et=new Array(s);for(let i=0;i<s;i++)t.it(),this.et[i]=new h,this.et[i].x=t.Z(0),this.et[i].y=t.Z(1),this.et[i].width=t.Z(2),this.et[i].height=t.Z(3);t.close()}let n=await fetch(t),a=await n.blob();await this.drawImage(await createImageBitmap(a),s),0!=(2&s)?(this.st=Math.floor(this.st/2),this.ht=Math.floor(this.ht/2)):0!=(4&s)&&(this.st*=2,this.ht*=2)}reset(){this.q&&(i.h.l.deleteTexture(this.q),this.q=null)}}class a{frame;ot;rt;lt}class o{ct;ut;loop;dt;ft;wt=0;max=0;gt=0;vt(){if(this.dt&&(this.ft[0].frame<0||-1!=this.loop)){this.wt=-this.ft[0].frame;for(let t=0;t<this.dt;++t)this.ft[t].frame+=this.wt}return this.dt&&(this.gt=this.ft[0].frame,this.max=this.ft[this.dt-1].frame),-1!=this.loop?this.loop>1?this.gt+(this.max-this.gt)*this.loop:this.max-this.wt:this.max-Math.min(this.wt,0)}yt(t){this.dt&&t[this.ct].$t(this.ut,this.ft[this.dt-1].ot)}}class r{xt;Mt;_t;async load(t){let i=new e;this._t=0,await i.K(t),i.tt();let s=parseInt(i.tt());i.it(),this.Mt=i.Z(0),this.xt=new Array(this.Mt);for(let t=0;t<this.Mt;t++){i.it();const h=new o;this.xt[t]=h,h.ct=i.Z(0),h.ut=i.Z(1),h.loop=i.Z(2),i.it(),h.dt=i.Z(0),h.ft=new Array(h.dt);for(let t=0;t<h.dt;t++)i.it(),h.ft[t]=new a,h.ft[t].frame=i.Z(0),h.ft[t].ot=i.Z(1),h.ft[t].rt=i.Z(2),h.ft[t].lt=s>=1?i.Z(3):0;let e=h.vt();e>this._t&&(this._t=e)}i.close()}}class l{isIdentity;matrix=new Float32Array(9);constructor(t){if(t)return this.isIdentity=!1,void this.matrix.set(t);this.identity()}clone(){return new l(this.matrix)}identity(){this.isIdentity||(this.isIdentity=!0,this.matrix[0]=1,this.matrix[1]=0,this.matrix[2]=0,this.matrix[3]=0,this.matrix[4]=1,this.matrix[5]=0,this.matrix[6]=0,this.matrix[7]=0,this.matrix[8]=1)}rotate(t,i){this.identity(),this.isIdentity=!1,this.matrix[0]=Math.cos(2*t*Math.PI/i),this.matrix[1]=-Math.sin(2*t*Math.PI/i),this.matrix[3]=Math.sin(2*t*Math.PI/i),this.matrix[4]=Math.cos(2*t*Math.PI/i)}bt(t,i,s){s.x=Math.floor(this.matrix[0]*t+this.matrix[1]*i+this.matrix[2]),s.y=Math.floor(this.matrix[3]*t+this.matrix[4]*i+this.matrix[5])}mul(t){let i=this.matrix[0]*t.matrix[0]+this.matrix[1]*t.matrix[3]+this.matrix[2]*t.matrix[6],s=this.matrix[0]*t.matrix[1]+this.matrix[1]*t.matrix[4]+this.matrix[2]*t.matrix[7],h=this.matrix[0]*t.matrix[2]+this.matrix[1]*t.matrix[5]+this.matrix[2]*t.matrix[8],e=this.matrix[3]*t.matrix[0]+this.matrix[4]*t.matrix[3]+this.matrix[5]*t.matrix[6],n=this.matrix[3]*t.matrix[1]+this.matrix[4]*t.matrix[4]+this.matrix[5]*t.matrix[7],a=this.matrix[3]*t.matrix[2]+this.matrix[4]*t.matrix[5]+this.matrix[5]*t.matrix[8],o=this.matrix[6]*t.matrix[0]+this.matrix[7]*t.matrix[3]+this.matrix[8]*t.matrix[6],r=this.matrix[6]*t.matrix[1]+this.matrix[7]*t.matrix[4]+this.matrix[8]*t.matrix[7],l=this.matrix[6]*t.matrix[2]+this.matrix[7]*t.matrix[5]+this.matrix[8]*t.matrix[8];this.matrix[0]=i,this.matrix[1]=s,this.matrix[2]=h,this.matrix[3]=e,this.matrix[4]=n,this.matrix[5]=a,this.matrix[6]=o,this.matrix[7]=r,this.matrix[8]=l}translate(t,i){this.identity(),this.isIdentity=!1,this.matrix[2]=t,this.matrix[5]=i}scale(t,i){this.identity(),this.isIdentity=!1,this.matrix[0]=t,this.matrix[4]=i}}class c{x=0;y=0}class u{It;Pt;At;Ft;Ct;Lt;Rt;St;Bt;Gt;Tt;Wt;kt;Dt;Ut;Nt;Ot;Xt;Yt;qt;Ht;s;jt;zt;Vt;Zt;rotation;Et;alpha;Kt;Jt;E=new Int32Array(8);Qt=new c;a=new l;ti=new l;ii=new l;si=new l;reset(t,i){this.Kt=1,this.Jt=1,this.Lt=0,this.St=0,this.Gt=0,this.Nt=0,this.Ut=0,this.qt=0,this.Wt=0,this.Yt=0,this.Zt=t,this.jt=t,this.Et=0,this.At=i}hi(t){let i,s,h;if(this.Ct+this.Lt!=-1)h=t.xt[this.Ct+this.Lt],this.s=i=Math.floor(this.Ht*this.jt*h.s/t.ei/t.ei),this.Vt=s=Math.floor(this.zt*this.Zt*h.Vt/t.ei/t.ei),this.Pt=Math.floor(this.alpha*this.At*h.It/t.ni/t.ni),this.It=Math.floor(this.alpha*this.At*h.It/t.ni/t.ni);else{i=this.Ht*this.jt/t.ei,this.s=i,s=this.zt*this.Zt/t.ei,this.Vt=s;let h=this.alpha*this.At/t.ni;this.It=h,this.Pt=h}this.Rt+this.St!=-1&&(this.E[0]=this.E[2]=-(this.Ot+this.Yt)*i/t.ei,this.E[4]=this.E[6]=i*t.ai.et[this.Bt+this.Gt].width/t.ei+this.E[0],this.E[1]=this.E[7]=-(this.Xt+this.qt)*s/t.ei,this.E[3]=this.E[5]=s*t.ai.et[this.Bt+this.Gt].height/t.ei+this.E[1]),this.ti.rotate(this.rotation+this.Et,t.oi),h?(this.ii.translate((this.kt+this.Ut)*h.s/t.ei,(this.Dt+this.Nt)*h.Vt/t.ei),this.si.scale(this.Kt,this.Jt)):(this.ii.translate(this.Ut,this.Nt),this.si.identity()),h?(this.a=h.a.clone(),this.a.mul(this.ii)):this.a=this.ii,this.a.mul(this.si),this.a.mul(this.ti);for(let t=0;t<8;t+=2)this.a.bt(this.E[t],this.E[t+1],this.Qt),this.E[t]=this.Qt.x,this.E[t+1]=this.Qt.y}ri(t,i,s,h){this.a.bt((i-this.Ot-this.Yt)*this.s/t.ei,(s-this.Xt-this.qt)*this.Vt/t.ei,h)}$t(t,i){switch(t){case 0:return void(this.Lt=i-this.Ct);case 1:return void(this.St=i-this.Rt);case 2:return void(this.Gt=i-this.Bt);case 3:return void(this.Wt=i-this.Tt);case 4:return void(this.Ut=i);case 5:return void(this.Nt=i);case 6:return void(this.Yt=i);case 7:return void(this.qt=i);case 8:return this.Zt=i,void(this.jt=i);case 9:return void(this.jt=i);case 10:return void(this.Zt=i);case 11:return void(this.Et=i);case 12:return void(this.At=i);case 13:return void(this.Kt=i?-1:1);case 14:return void(this.Jt=i?-1:1);default:throw"Unhandled modification type: "+t}}li(t,i,s,h){if(this.Rt<0||this.Bt<0)return;if(i.U(this.Ft),1==this.Ft)i.setAlpha(0);else{const s=this.Pt/t.ni;if(!s)return;i.setAlpha(s)}const e=t.ai,n=e.et[this.Gt+this.Bt];i.O(e,this.E[0]+s,this.E[1]+h,this.E[2]+s,this.E[3]+h,this.E[4]+s,this.E[5]+h,this.E[6]+s,this.E[7]+h,n.x,n.y,n.width,n.height)}}class d{a;b;c;d;e;f;ci;It(){return this.a}ui(){return this.d}di(){return this.e}}class f{ai;xt;Mt;fi;e;ei;oi;ni;mi;wi;pi(t){return this.mi[t]}gi(t){this.ai=t}vi(t,i){const h=s.h;for(let s=0;s<this.Mt;s++)this.xt[this.fi[s]].li(this,h,t,i)}yi(t,i,s){let h=i,e=i;for(let s=i-1;s>=0&&3==t[s].rt;s--)h=s;for(let s=i+1;s<t.length&&3==t[e=s].rt;s++);let n=0;for(let i=h;i<=e;i++){let a=4096*t[i].ot;for(let n=h;n<=e;n++)i!=n&&(a*=(s-t[n].frame)/(t[i].frame-t[n].frame));n+=a}return Math.floor(n/4096)}hi(t,i){if(!i)for(let t of this.xt)t.reset(this.ei,this.ni);for(let s of t.xt){const t=s.loop,h=s.max,e=s.gt,n=h-e;let a=i+s.wt;if(t>0&&n){if(a>e+t*n){s.yt(this.xt);continue}a<=e||(a=a<e+t*n?e+(a-e)%n:h)}for(let t=0;t<s.dt;++t)if(a==s.ft[t].frame)this.xt[s.ct].$t(s.ut,s.ft[t].ot);else if(t<s.dt-1&&a>s.ft[t].frame&&a<s.ft[t+1].frame){if(s.ut>1){const i=s.ft[t].frame,h=s.ft[t].ot,e=s.ft[t+1].frame,n=s.ft[t+1].ot;let o,r=(a-i)/(e-i);if(1==s.ft[t].rt||13==s.ut||14==s.ut)r=0;else if(2==s.ft[t].rt)r=s.ft[t].lt>=0?1-Math.sqrt(1-Math.pow(r,s.ft[t].lt)):Math.sqrt(1-Math.pow(1-r,-s.ft[t].lt));else{if(3==s.ft[t].rt){o=this.yi(s.ft,t,a),this.xt[s.ct].$t(s.ut,o);break}4==s.ft[t].rt&&(r=s.ft[t].lt>0?1-Math.cos(r*Math.PI/2):s.ft[t].lt<0?Math.sin(r*Math.PI/2):(1-Math.cos(r*Math.PI))/2)}o=2==s.ut&&n-h<0?~~Math.ceil((n-h)*r+h):~~((n-h)*r+h),this.xt[s.ct].$t(s.ut,o);break}0==s.ut&&this.xt[s.ct].$t(0,s.ft[t].ot)}}for(let t of this.xt)t.hi(this);for(let t=0;t<this.Mt;t++)this.fi[t]=t,this.e[t]=this.xt[t].Tt+this.xt[t].Wt;for(let t=1;t<this.Mt;t++){let i=this.fi[t],s=this.e[t],h=t-1;for(;h>=0&&this.e[h]>s;)this.fi[h+1]=this.fi[h],this.e[h+1]=this.e[h],h--;this.fi[h+1]=i,this.e[h+1]=s}}async load(t){let i=new e;this.reset(),await i.K(t),i.tt(),i.it();let s=i.Z(0);i.it(),this.Mt=i.Z(0),this.xt=new Array(this.Mt),this.fi=new Int32Array(this.Mt),this.e=new Int32Array(this.Mt);for(let t=0;t<this.Mt;t++)i.it(),this.xt[t]=new u,this.xt[t].Ct=i.Z(0),this.xt[t].Rt=i.Z(1),this.xt[t].Bt=i.Z(2),this.xt[t].Tt=i.Z(3),this.xt[t].kt=i.Z(4),this.xt[t].Dt=i.Z(5),this.xt[t].Ot=i.Z(6),this.xt[t].Xt=i.Z(7),this.xt[t].Ht=i.Z(8),this.xt[t].zt=i.Z(9),this.xt[t].rotation=i.Z(10),this.xt[t].alpha=i.Z(11),this.xt[t].Ft=s>=2?i.Z(12):0;if(s>=1?(i.it(),this.ei=i.Z(0),this.oi=i.Z(1),this.ni=i.Z(2)):(this.ei=100,this.oi=360,this.ni=255),s>=3){i.it(),this.wi=i.Z(0),this.mi=new Array(this.wi);for(let t=0;t<this.wi;t++)i.it(),this.mi[t]=new d,this.mi[t].b=i.Z(0),this.mi[t].a=this.xt[this.mi[t].b],this.mi[t].c=i.Z(1),this.mi[t].d=i.Z(2),this.mi[t].e=i.Z(3),this.mi[t].f=i.Z(4),this.mi[t].ci=i.Z(5)}else this.wi=0;i.close()}$i(){return this.xt[0]}xi(){return this.ei}reset(){this.xt=void 0,this.fi=void 0,this.e=void 0,this.mi=void 0}}const m=GIF;var w=t.n(m);class p{static Mi=[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,2,2,3,3,3,3,3,3,3,2,3,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,2,2,3,3,3,3,3,3,3,3,3,3,2,2,3,3,3,3,3,2,3,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,3,3,3,2,2,2,2,2,2,3,3,3,3,3,3,3,2,2,3,2,3,3,2,2,3,2,3,2,3,3,2,2,3,2,2,3,3,3,3,3,3,2,3,2,3,2,2,2,2,2,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,2,2,2,2,2,2,2,2,3,3,3,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,3,3,2,3,3,3,3,2,2,3,2,2,2,2,2,3,3,3,2,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,2,3,2,3,3,3,3,3,2,3,3,3,3,3,2,3,2,2,3,3,2,3,3,3,3,2,2,2,3,3,3,3,2,3,3,3,3,3,1,3,3,2,2,3,3,2,3,2,2,2,3,3,3,2,3,2,3,3,3,3,3,3,2,2,2,2,2,2,3,3,2,2,2,2,2,3,3,2,3,2,2,3,3,2,3,2,2,2,2,3,3,3,3,3,3,3,3,2,2,2,3,3,2,2,3,2,2,2,3,3,2,2,3,3,2,2,3,2,2,2,2,2,2,2,2,3,3,2,2,2,3,2,2,2,2,3,3,2,3,2,2,3,3,3,3,3,3,2,2,3,2,3,2,2,2,3,2,2,2,2,2,3,2,3,2,2,3,3,3,2,2,2,3,3,2,2,2,2,3,2,2,3,2,2,2,2,2,3,2,2,2,3,2,2,3,3,2,2,2,2,2,3,2,2,3,3,2,2,2,2,3,2,2,2,2,2,2,2,3,2,3,3,3,2,3,2,2,2,2,2,3,3,3,3,2,2,2,2,3,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,3,3,3,3,3,2,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,3,2,2,2,2,3,3,2,2,2,2,2,2,2,2,2,2,2,3,2,2,3,2,2,3,3,2,2,3,3,3,3,3,2,2,2,2,2,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,3,3,3,2,2,2,2,2,2,2,2,3,2,2,3,2,3,3,2,2,2,3,3,3,2,2,2,3,3,2,2,1,2,3,3,2,2,2,2,2,2,2,2,3,2,2,2,2,2,3,2,2,2,2,2,3,2,2,3,2,2,2,2,2,3,3,2,2,2,2,2,3,2,2,3,3,2,2,3];static _i={656:[1,0],658:[2,0],659:[7,0],663:[4,0],664:[3,0],665:[9,0],669:[9,0],670:[2,0],675:[7,0],676:[6,0],685:[1,0],691:[10,0],697:[8,0],700:[1,0],706:[7,0],707:[9,0],713:[8,0],716:[1,0],717:[6,0],720:[9,0]};bi;Ii;Pi;Ai;Fi;Ci;Li;Ri;Si;Bi;Gi=!1;Ti;Wi;ki;Di;stopped=!0;Ui=0;Ni=0;Oi=new Array(2);Xi=new Array(3);Yi=new Array(3);stop=!1;qi=1e3/30;then=0;Hi;ji(){if(i.h.canvas=document.getElementById("canvas"),this.Pi=document.getElementById("animtype"),this.bi=document.getElementById("next"),this.Ii=document.getElementById("pause"),this.Ai=document.getElementById("unitid"),this.Fi=document.getElementById("range"),this.Ci=document.getElementById("downloadImg"),this.Li=document.getElementById("downloadV"),this.Ri=document.getElementById("icons"),i.h.l=i.h.canvas.getContext("webgl2"),!i.h.l&&(console.warn("WebGL2 is not available, fallback to webgl"),i.h.l=i.h.canvas.getContext("webgl"),!i.h.l))throw alert("您的瀏覽器不支援WebGL2"),"";this.Hi=this.animate.bind(this);function t(t,s){const h=i.h.l.createShader(t);if(i.h.l.shaderSource(h,s),i.h.l.compileShader(h),!i.h.l.getShaderParameter(h,i.h.l.COMPILE_STATUS))throw alert(i.h.l.getShaderInfoLog(h)),"";return h}const h=i.h.l.createProgram();function e(){const t=i.h.canvas,s=i.h.l,h=t.clientWidth,e=t.clientHeight;t.width=h,t.height=e,i.h.I(0,h,e,0,-1,1),s.uniformMatrix4fv(i.h.v,!1,i.h.matrix),s.viewport(0,0,t.clientWidth,t.clientHeight),i.h.$=t.clientWidth/2,i.h.M=t.clientHeight/2+100}i.h.l.attachShader(h,t(i.h.l.VERTEX_SHADER,"\nattribute vec2 vertexPosition;\nattribute vec2 texturePosition;\nattribute float alphaC;\nuniform mat4 u_matrix;\n\nvarying float v_alpha;\nvarying vec2 vTexturePosition;\n\nvoid main(void) {\n\tgl_Position = u_matrix * vec4(vertexPosition, 0.0, 1.0);\n\tvTexturePosition = texturePosition;\n\tv_alpha = alphaC;\n}")),i.h.l.attachShader(h,t(i.h.l.FRAGMENT_SHADER,"\nprecision mediump float;\n\nuniform sampler2D sampler;\nvarying vec2 vTexturePosition;\nvarying float v_alpha;\n\nvoid main(void) {\n\tgl_FragColor = texture2D(sampler, vTexturePosition) * v_alpha;\n}")),i.h.l.linkProgram(h),i.h.l.useProgram(h),i.h.o=h,i.h.position=i.h.l.getAttribLocation(h,"vertexPosition"),i.h.m=i.h.l.getAttribLocation(h,"texturePosition"),i.h.v=i.h.l.getUniformLocation(h,"u_matrix"),i.h.u=i.h.l.createBuffer(),i.h.p=i.h.l.createBuffer(),i.h.g=i.h.l.getAttribLocation(h,"alphaC"),e(),window.onresize=e,s.h.H();for(let t=0;t<3;++t)this.Oi[t]=new n;for(let t=0;t<3;++t)this.Yi[t]=new f;for(let t=0;t<3;++t){const i=this.Xi[t]=new Array(4);for(let t=0;t<4;++t)i[t]=new r}this.Ai.onchange=this.zi.bind(this);{const t=new URL(location.href).searchParams.get("id");if(t){const i=parseInt(t);isFinite(i)&&i&&(this.Ai.value=i.toString())}}this.zi({currentTarget:this.Ai});let a=this;this.Ii.onclick=function(){a.stopped?(a.stop=!1,a.stopped=!1,a.animate()):(a.ki=NaN,a.stop=!0)},this.bi.onclick=function(){a.stopped&&(a.Fi.value=(++a.Di).toString(),a.Vi())},this.Fi.oninput=function(){a.stopped&&(a.Di=parseInt(a.Fi.value),a.Vi())},this.Pi.oninput=function(){a.Di=0,a.Vi(),a.Ui=a.Pi?.selectedIndex,a.Fi.max=a.Xi[a.Ni][a.Ui]._t.toString()},this.Ci.onclick=function(){const t=s.h;t.k(),a.Vi(),t.D();const h=document.createElement("canvas"),e=h.getContext("2d");h.width=Math.max(t.S-t.R,100),h.height=Math.max(t.B-t.G,100),t.T=t.R,t.W=t.G,a.Vi(),e.drawImage(i.h.l.canvas,0,0),h.toBlob((function(t){const i=document.createElement("a"),s=window.URL.createObjectURL(t);i.href=s,i.download=`Cat No.${a.ki}.png`,i.click()}))},this.Li.onclick=function(){a.stop=!0,a.Di=0;const t=i.h.l;let h=prompt("每禎延遲(毫秒)\n延遲 = 1000 / 禎率 = 1000 / 30 = 33.33...","33");if(!h)return;if(h=parseInt(h),!isFinite(h)||h<=0)return;let e=prompt("開始禎","0");if(!e)return;e=parseInt(e);const n=a.Xi[a.Ni][a.Ui]._t;if(!isFinite(e)||e<0||e>n)return;let o=prompt("結束禎",n.toString());if(!o)return;if(o=parseInt(o),!isFinite(o)||e>o)return;let r=prompt("精度(像素採樣間隔，越低品質越好，最低1)","10");if(!r)return;if(r=parseInt(r),!isFinite(r)||r<=0)return;const l=s.h;l.k();for(let t=e;t<=o;++t)a.Vi(),a.Di=t;l.D();const c=document.createElement("canvas"),u=c.getContext("2d",{Zi:!0});c.width=Math.max(l.S-l.R,100),c.height=Math.max(l.B-l.G,100),l.T=l.R,l.W=l.G,t.clearColor(0,0,0,1);const d=new(w())({quality:r,width:c.width,height:c.height});for(let i=e;i<=o;++i)a.Vi(),a.Di=i,u.drawImage(t.canvas,0,0),d.frames.push({data:u.getImageData(0,0,c.width,c.height).data,delay:h,Ei:!1,Ki:-1});t.clearColor(0,0,0,0),l.T=l.W=0;let f=a.Fi?.max;a.Fi.value="0",d.on("progress",(function(t){a.Fi.value=(~~(1e3*t)).toString()})),d.on("finished",(function(t){const i=document.createElement("a"),s=window.URL.createObjectURL(t);i.href=s,i.download="animation.gif",i.click(),a.Fi.value=f})),d.render(),s.h.j()};for(let t of this.Ri.children)t.onclick=function(t){const i=t.currentTarget;a.Ni=parseInt(i.getAttribute("data-i"));for(let t of a.Ri?.children)t.className=t==i?"active":"";a.Fi.max=a.Xi[a.Ni][a.Ui]._t.toString(),a.Fi.value="0",a.Di=0,a.stopped&&a.Vi()};i.h.canvas.addEventListener("mousedown",(function(t){a.Gi=!0})),i.h.canvas.addEventListener("mouseup",(function(t){a.Gi=!1})),i.h.canvas.addEventListener("mousemove",(function(t){a.Gi&&(i.h.$+=t.movementX,i.h.M+=t.movementY,a.stopped&&a.Vi())})),i.h.canvas.addEventListener("touchstart",(function(t){a.Gi=!0,a.Ti=t.touches[0].clientX,a.Wi=t.touches[0].clientY,t.preventDefault()})),i.h.canvas.addEventListener("touchend",(function(t){a.Gi=!1,t.preventDefault()})),i.h.canvas.addEventListener("touchmove",(function(t){const{clientX:s,clientY:h}=t.changedTouches[0];i.h.$+=s-a.Ti,i.h.M+=h-a.Wi,a.Ti=s,a.Wi=h,a.stopped&&a.Vi(),t.preventDefault()})),(this.Si=document.getElementById("color1")).oninput=function(){i.h.canvas.style.setProperty("background",`linear-gradient(${a.Si.value},${a.Bi.value})`,"important"),localStorage.setItem("color1",a.Si.value),localStorage.setItem("color2",a.Bi.value)},(this.Bi=document.getElementById("color2")).oninput=function(){i.h.canvas.style.setProperty("background",`linear-gradient(${a.Si.value},${a.Bi.value})`,"important"),localStorage.setItem("color1",a.Si.value),localStorage.setItem("color2",a.Bi.value)};let o=localStorage.getItem("color1");if(o){let t=localStorage.getItem("color2");t&&(a.Si.value=o,a.Bi.value=t,i.h.canvas.style.setProperty("background",`linear-gradient(${o},${t})`,"important"))}document.getElementById("zoom").oninput=function(t){const s=t.currentTarget,h=parseInt(s.value)/100,e=i.h.canvas,n=i.h.l;let o=e.clientWidth,r=e.clientHeight;e.width=o,e.height=r,n.viewport(0,0,o,r),o*=h,r*=h,i.h.I(0,o,r,0,-1,1),n.uniformMatrix4fv(i.h.v,!1,i.h.matrix),i.h.$=o/2,i.h.M=(e.clientHeight/2+100)*h,a.stopped&&a.Vi()},document.getElementById("fps").oninput=function(t){const i=t.currentTarget;a.qi=1e3/parseInt(i.value)}}Vi(){let t=new c;const h=this.Yi[this.Ni],e=this.Ui,n=this.Xi[this.Ni][e];this.Di>n._t&&(this.Di=0),h.hi(n,this.Di);h.pi(0).It().ri(h,h.pi(0).ui(),h.pi(0).di(),t),s.h.j(),h.vi(i.h.$-t.x,i.h.M-t.y)}async zi(t){let i=parseInt(t.currentTarget.value);if(!isFinite(i))return;this.ki=NaN,this.stop=!0;const s=new URL(location.href);s.searchParams.set("id",i.toString()),history.pushState({},"",s),await this.Ji(i),this.ki=i,this.stopped&&(this.stopped=!1,this.stop=!1,this.Di=0,this.animate())}animate(t){if(null!=t&&(this.Fi.value=this.Di.toString()),this.stop){if(isNaN(this.ki)){this.stopped=!0;let t=parseInt(this.Ai.value);if(!isFinite(t))return;this.ki=t}else this.stop=!1,this.Di=0,this.stopped=!1,this.animate();return}requestAnimationFrame(this.Hi);const i=performance.now(),s=i-this.then;s>this.qi&&(this.then=i-s%this.qi,this.Vi(),++this.Di)}async Ji(t){if(this.Ni=0,t<0){-0==(t=-(t+1))&&(t=0);let s=i._(t);for(let t of this.Oi)t.reset();let h=new Array;h.push(this.Oi[0].load(`/data/enemy/${s}/${s}_e.png`,`/data/enemy/${s}/${s}_e.imgcut`,0));for(let t=0;t<4;++t)h.push(this.Xi[0][t].load(`/data/enemy/${s}/${s}_e0${t}.maanim`));const e=this.Yi[0];e.gi(this.Oi[0]),h.push(e.load(`/data/enemy/${s}/${s}_e.mamodel`)),await Promise.all(h),this.Fi.max=this.Xi[0][this.Ui]._t.toString();const n=this.Ri?.children;return n[0].style.display="none",n[1].style.display="none",void(n[2].style.display="none")}let s=i._(t);for(let t of this.Oi)t.reset();const h=p.Mi[t];let e=new Array;const n=p._i[t.toString()]||[];for(let t=0;t<n.length;++t)n[t]=i._(n[t]);for(let t=0;t<h;++t){if(null!=n[t]){e.push(this.Oi[t].load(`/data/img/m/${n[t]}/${n[t]}_m.png`,`/data/img/m/${n[t]}/${n[t]}_m.imgcut`,0));continue}const i="fcs"[t];e.push(this.Oi[t].load(`/data/unit/${s}/${i}/${s}_${i}.png`,`/data/unit/${s}/${i}/${s}_${i}.imgcut`,0))}for(let t=0;t<h;++t){if(null!=n[t]){for(let i=0;i<4;++i)e.push(this.Xi[t][i].load(`/data/img/m/${n[t]}/${n[t]}_m0${i}.maanim`));continue}const i="fcs"[t];for(let h=0;h<4;++h)e.push(this.Xi[t][h].load(`/data/unit/${s}/${i}/${s}_${i}0${h}.maanim`))}for(let t=0;t<h;++t){const i=this.Yi[t];if(null!=n[t]){i.gi(this.Oi[t]),e.push(i.load(`/data/img/m/${n[t]}/${n[t]}_m.mamodel`));continue}const h="fcs"[t];i.gi(this.Oi[t]),e.push(i.load(`/data/unit/${s}/${h}/${s}_${h}.mamodel`))}await Promise.all(e);const a=this.Ri?.children;for(let t=0;t<3;++t){const i=a[t];if(t>=h)i.style.display="none";else if(i.style.display="block",null!=n[t])i.src=`/data/img/m/${n[t]}/uni${n[t]}_m00.png`;else{const h="fcs"[t];i.src=`/data/unit/${s}/${h}/uni${s}_${h}00.png`}i.className=t?"":"active"}this.Fi.max=this.Xi[0][this.Ui]._t.toString()}}(new p).ji()})();
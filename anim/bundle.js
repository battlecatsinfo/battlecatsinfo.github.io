(()=>{"use strict";var t={n:i=>{var s=i&&i.t?()=>i.default:()=>i;return t.d(s,{a:s}),s},d:(i,s)=>{for(var h in s)t.i(s,h)&&!t.i(i,h)&&Object.defineProperty(i,h,{enumerable:!0,get:s[h]})},i:(t,i)=>Object.prototype.hasOwnProperty.call(t,i)};class i{static h=new i;o;canvas;l;position;u;m;p;g;v;matrix=new Float32Array(16);$;M;static _(t){let i=t.toString();switch(i.length){case 3:return i;case 2:return"0"+i;default:return"00"+i}}I(t,i,s,h,e,n){this.matrix[0]=2/(i-t),this.matrix[1]=0,this.matrix[2]=0,this.matrix[3]=0,this.matrix[4]=0,this.matrix[5]=2/(h-s),this.matrix[6]=0,this.matrix[7]=0,this.matrix[8]=0,this.matrix[9]=0,this.matrix[10]=2/(e-n),this.matrix[11]=0,this.matrix[12]=(t+i)/(t-i),this.matrix[13]=(s+h)/(s-h),this.matrix[14]=(e+n)/(e-n),this.matrix[15]=1}scale(t,i){this.matrix[0]*=t,this.matrix[1]*=t,this.matrix[2]*=t,this.matrix[3]*=t,this.matrix[4]*=i,this.matrix[5]*=i,this.matrix[6]*=i,this.matrix[7]*=i}translate(t,i){this.matrix[12]=this.matrix[0]*t+this.matrix[4]*i+this.matrix[8]+this.matrix[12],this.matrix[13]=this.matrix[1]*t+this.matrix[5]*i+this.matrix[9]+this.matrix[13],this.matrix[14]=this.matrix[2]*t+this.matrix[6]*i+this.matrix[10]+this.matrix[14],this.matrix[15]=this.matrix[3]*t+this.matrix[7]*i+this.matrix[11]+this.matrix[15]}}class s{static h=new s;P=new Float32Array(8);A;F;C;L=!1;k;R;S;B;G=0;T=0;W(){this.k=i.h.canvas.width,this.R=0,this.B=i.h.canvas.height,this.S=0,this.L=!0}D(){this.L=!1,this.k=Math.max(0,this.k-10),this.R=this.R+10,this.B=Math.max(0,this.B-10),this.S=this.S+10}U(t){switch(t){case 0:this.A=WebGL2RenderingContext.SRC_ALPHA,this.F=WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA;break;case 1:this.A=WebGL2RenderingContext.SRC_ALPHA,this.F=WebGL2RenderingContext.ONE;break;case 3:this.A=WebGL2RenderingContext.ZERO,this.F=WebGL2RenderingContext.SRC_COLOR;break;case 4:this.A=WebGL2RenderingContext.ONE_MINUS_DST_COLOR,this.F=WebGL2RenderingContext.ONE}}N(t){this.C=t}O(t,s,h,e,n,a,o,r,l,c,u,f,d){if(this.L)return this.k=Math.min(s,e,a,r,this.k),this.R=Math.max(s,e,a,r,this.R),this.B=Math.min(h,n,o,l,this.B),void(this.S=Math.max(h,n,o,l,this.S));const m=i.h.l;this.P[0]=s-this.G,this.P[1]=h-this.T,this.P[2]=e-this.G,this.P[3]=n-this.T,this.P[4]=r-this.G,this.P[5]=l-this.T,this.P[6]=a-this.G,this.P[7]=o-this.T,m.blendFunc(this.A,this.F),m.bindBuffer(m.ARRAY_BUFFER,i.h.u),m.bufferData(m.ARRAY_BUFFER,this.P,m.STATIC_DRAW),this.P[0]=c,this.P[1]=u,this.P[2]=c,this.P[3]=u+d,this.P[4]=c+f,this.P[5]=u,this.P[6]=c+f,this.P[7]=u+d;for(let i=0;i<8;)this.P[i++]/=t.X,this.P[i++]/=t.Y;m.bindBuffer(m.ARRAY_BUFFER,i.h.p),m.bufferData(m.ARRAY_BUFFER,this.P,m.STATIC_DRAW),m.bindTexture(m.TEXTURE_2D,t.q),m.drawArrays(m.TRIANGLE_STRIP,0,4)}H(){const t=i.h.l;t.clearColor(0,0,0,0),t.bindBuffer(t.ARRAY_BUFFER,i.h.u),t.vertexAttribPointer(i.h.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(i.h.position),t.bindBuffer(t.ARRAY_BUFFER,i.h.p),t.vertexAttribPointer(i.h.m,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(i.h.m),t.enable(t.BLEND),t.blendFuncSeparate(t.ONE_MINUS_SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE),t.blendEquation(t.FUNC_ADD),this.U(0)}setAlpha(t){i.h.l.vertexAttrib1f(i.h.g,t)}j(){const t=i.h.l;t.clear(t.COLOR_BUFFER_BIT)}}class h{x;y;width;height}class e{a;b;V=0;Z(t){return parseInt(this.b[t])}async K(t){const i=await fetch(t);if(!i.ok)throw"File not found";this.a=await i.text()}J(t){return this.b[t]}tt(){if(this.V>=this.a.length)return null;let t=this.V;if(this.V=this.a.indexOf("\n",t),-1==this.V)return this.V=this.a.length,this.a.slice(t);let i=this.a.slice(t,this.V++);return i.includes("\r")?i.replaceAll("\r",""):i}it(t=","){let i=this.tt();return i&&(this.b=i.split(t)),this.b}c(){return this.a}close(){}}class n{q;st;ht;X;Y;name;et;nt;async drawImage(t,s){let h=t.width;this.st=h;let e=t.height;this.ht=e;let n=1;for(;n<h;)n*=2;this.X=n;let a=1;for(;a<e;)a*=2;this.Y=a;const o=document.createElement("canvas"),r=o.getContext("2d");o.width=n,o.height=a,r.drawImage(t,0,0);const l=i.h.l;this.q=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.q),0!=(8&s)?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST)):(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR)),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,o)}async load(t,i,s=0){if(this.reset(),this.nt=s,null!=i)if(0!=(1&s)){let t=new e;await t.K(i),t.tt(),t.tt(),t.tt(),t.it();let s=t.Z(0);this.et=new Array(s);for(let i=0;i<s;i++)t.it(),this.et[i].x=t.Z(0),this.et[i].y=t.Z(1),this.et[i].width=t.Z(2),this.et[i].height=t.Z(3);t.close()}else{let t=new e;await t.K(i),t.tt(),t.tt(),t.tt(),t.it();let s=t.Z(0);this.et=new Array(s);for(let i=0;i<s;i++)t.it(),this.et[i]=new h,this.et[i].x=t.Z(0),this.et[i].y=t.Z(1),this.et[i].width=t.Z(2),this.et[i].height=t.Z(3);t.close()}let n=await fetch(t),a=await n.blob();await this.drawImage(await createImageBitmap(a),s),0!=(2&s)?(this.st=Math.floor(this.st/2),this.ht=Math.floor(this.ht/2)):0!=(4&s)&&(this.st*=2,this.ht*=2)}reset(){this.q&&(i.h.l.deleteTexture(this.q),this.q=null)}}class a{frame;ot;rt;lt}class o{ct;ut;loop;ft;dt;wt=0;max=0;gt(){let t=0;if(this.ft&&(this.dt[0].frame<0||-1!=this.loop)){this.wt=-this.dt[0].frame;for(let t=0;t<this.ft;++t)this.dt[t].frame+=this.wt}return this.ft&&(t=this.dt[0].frame,this.max=this.dt[this.ft-1].frame),-1!=this.loop?this.loop>1?t+(this.max-t)*this.loop:this.max-this.wt:this.max-Math.min(this.wt,0)}}class r{yt;vt;$t;async load(t){let i=new e;this.$t=0,await i.K(t),i.tt();let s=parseInt(i.tt());i.it(),this.vt=i.Z(0),this.yt=new Array(this.vt);for(let t=0;t<this.vt;t++){i.it();const h=new o;this.yt[t]=h,h.ct=i.Z(0),h.ut=i.Z(1),h.loop=i.Z(2),i.it(),h.ft=i.Z(0),h.dt=new Array(h.ft);for(let t=0;t<h.ft;t++)i.it(),h.dt[t]=new a,h.dt[t].frame=i.Z(0),h.dt[t].ot=i.Z(1),h.dt[t].rt=i.Z(2),h.dt[t].lt=s>=1?i.Z(3):0;let e=h.gt();e>this.$t&&(this.$t=e)}i.close()}}class l{isIdentity;matrix=new Float32Array(9);constructor(t){if(t)return this.isIdentity=!1,void this.matrix.set(t);this.identity()}clone(){return new l(this.matrix)}identity(){this.isIdentity||(this.isIdentity=!0,this.matrix[0]=1,this.matrix[1]=0,this.matrix[2]=0,this.matrix[3]=0,this.matrix[4]=1,this.matrix[5]=0,this.matrix[6]=0,this.matrix[7]=0,this.matrix[8]=1)}rotate(t,i){this.identity(),this.isIdentity=!1,this.matrix[0]=Math.cos(2*t*Math.PI/i),this.matrix[1]=-Math.sin(2*t*Math.PI/i),this.matrix[3]=Math.sin(2*t*Math.PI/i),this.matrix[4]=Math.cos(2*t*Math.PI/i)}xt(t,i,s){s.x=Math.floor(this.matrix[0]*t+this.matrix[1]*i+this.matrix[2]),s.y=Math.floor(this.matrix[3]*t+this.matrix[4]*i+this.matrix[5])}mul(t){let i=this.matrix[0]*t.matrix[0]+this.matrix[1]*t.matrix[3]+this.matrix[2]*t.matrix[6],s=this.matrix[0]*t.matrix[1]+this.matrix[1]*t.matrix[4]+this.matrix[2]*t.matrix[7],h=this.matrix[0]*t.matrix[2]+this.matrix[1]*t.matrix[5]+this.matrix[2]*t.matrix[8],e=this.matrix[3]*t.matrix[0]+this.matrix[4]*t.matrix[3]+this.matrix[5]*t.matrix[6],n=this.matrix[3]*t.matrix[1]+this.matrix[4]*t.matrix[4]+this.matrix[5]*t.matrix[7],a=this.matrix[3]*t.matrix[2]+this.matrix[4]*t.matrix[5]+this.matrix[5]*t.matrix[8],o=this.matrix[6]*t.matrix[0]+this.matrix[7]*t.matrix[3]+this.matrix[8]*t.matrix[6],r=this.matrix[6]*t.matrix[1]+this.matrix[7]*t.matrix[4]+this.matrix[8]*t.matrix[7],l=this.matrix[6]*t.matrix[2]+this.matrix[7]*t.matrix[5]+this.matrix[8]*t.matrix[8];this.matrix[0]=i,this.matrix[1]=s,this.matrix[2]=h,this.matrix[3]=e,this.matrix[4]=n,this.matrix[5]=a,this.matrix[6]=o,this.matrix[7]=r,this.matrix[8]=l}translate(t,i){this.identity(),this.isIdentity=!1,this.matrix[2]=t,this.matrix[5]=i}scale(t,i){this.identity(),this.isIdentity=!1,this.matrix[0]=t,this.matrix[4]=i}}class c{x=0;y=0}class u{Mt;bt;_t;It;Pt;At;Ft;Ct;Lt;kt;Rt;St;Bt;Gt;Tt;Wt;Dt;Ut;Nt;Ot;Xt;s;Yt;qt;Ht;jt;rotation;zt;alpha;Vt;Zt;E=new Int32Array(8);Et=new c;a=new l;Kt=new l;Jt=new l;Qt=new l;update(t){let i,s,h;if(this.Pt+this.At!=-1)h=t.yt[this.Pt+this.At],this.s=i=Math.floor(this.Xt*this.Yt*h.s/t.ti/t.ti),this.Ht=s=Math.floor(this.qt*this.jt*h.Ht/t.ti/t.ti),this.bt=Math.floor(this.alpha*this._t*h.Mt/t.ii/t.ii),this.Mt=Math.floor(this.alpha*this._t*h.Mt/t.ii/t.ii);else{i=this.Xt*this.Yt/t.ti,this.s=i,s=this.qt*this.jt/t.ti,this.Ht=s;let h=this.alpha*this._t/t.ii;this.Mt=h,this.bt=h}this.Ft+this.Ct!=-1&&(this.E[0]=this.E[2]=-(this.Dt+this.Nt)*i/t.ti,this.E[4]=this.E[6]=i*t.si.et[this.Lt+this.kt].width/t.ti+this.E[0],this.E[1]=this.E[7]=-(this.Ut+this.Ot)*s/t.ti,this.E[3]=this.E[5]=s*t.si.et[this.Lt+this.kt].height/t.ti+this.E[1]),this.Kt.rotate(this.rotation+this.zt,t.hi),h?(this.Jt.translate((this.Bt+this.Tt)*h.s/t.ti,(this.Gt+this.Wt)*h.Ht/t.ti),this.Qt.scale(this.Vt,this.Zt)):(this.Jt.translate(this.Tt,this.Wt),this.Qt.identity()),h?(this.a=h.a.clone(),this.a.mul(this.Jt)):this.a=this.Jt,this.a.mul(this.Qt),this.a.mul(this.Kt);for(let t=0;t<8;t+=2)this.a.xt(this.E[t],this.E[t+1],this.Et),this.E[t]=this.Et.x,this.E[t+1]=this.Et.y}ei(t,i,s,h){this.a.xt((i-this.Dt-this.Nt)*this.s/t.ti,(s-this.Ut-this.Ot)*this.Ht/t.ti,h)}ni(t,i,s,h){if(this.Ft<0||this.Lt<0)return;if(i.U(this.It),1==this.It)i.setAlpha(0);else{if(this.bt<=1e-5)return;i.setAlpha(this.bt/t.ii)}const e=t.si,n=e.et[this.kt+this.Lt];i.O(e,this.E[0]+s,this.E[1]+h,this.E[2]+s,this.E[3]+h,this.E[4]+s,this.E[5]+h,this.E[6]+s,this.E[7]+h,n.x,n.y,n.width,n.height)}}class f{a;b;c;d;e;f;ai;Mt(){return this.a}oi(){return this.d}ri(){return this.e}}class d{si;yt;vt;li;e;ti;hi;ii;ci;ui;fi(t){return this.ci[t]}di(t){this.si=t}mi(t,i){const h=s.h;for(let s=0;s<this.vt;s++)this.yt[this.li[s]].ni(this,h,t,i)}wi(t,i,s){let h=i,e=i;for(let s=i-1;s>=0&&3==t[s].rt;s--)h=s;for(let s=i+1;s<t.length&&3==t[e=s].rt;s++);let n=0;for(let i=h;i<=e;i++){let a=4096*t[i].ot;for(let n=h;n<=e;n++)i!=n&&(a*=(s-t[n].frame)/(t[i].frame-t[n].frame));n+=a}return Math.floor(n/4096)}pi(t,i=0){let s;for(let t=0;t<this.vt;t++){let i=this.yt[t];i.Vt=1,i.Zt=1,i.At=0,i.Ct=0,i.kt=0,i.Wt=0,i.Tt=0,i.Ot=0,i.St=0,i.Nt=0,i.jt=this.ti,i.Yt=this.ti,i.zt=0,i._t=this.ii}if(t)for(let h=0;h<t.vt;h++){s=0;const e=t.yt[h];let n=e.dt[0].frame,a=e.max,o=-1;if(i>=n&&(o=i<a||n==a?i:-1==e.loop||e.loop>=1&&(i-n)/(a-n)<e.loop?(i-n)%(a-n):a),o>=0){if(n==a)s=e.dt[0].ot;else if(o==a)s=e.dt[e.ft-1].ot;else{let t=0;for(;t<e.ft-1;){const i=e.dt[t],h=e.dt[t+1],n=i.frame,a=h.frame,r=i.rt;if(!(o<n||o>=a)){if(0==r){s=(h.ot-i.ot)*(o-n)/(a-n)+i.ot;break}if(1==r){s=i.ot;break}if(2==r){s=Math.floor(i.lt>=0?(1-Math.sqrt(1-Math.pow((o-n)/(a-n),i.lt)))*(h.ot-i.ot)+i.ot:Math.sqrt(1-Math.pow(1-(o-n)/(a-n),-i.lt))*(h.ot-i.ot)+i.ot);break}if(3==r){s=this.wi(e.dt,t,o);break}if(4==r){const t=(o-n)/(a-n);s=i.lt>0?1-Math.cos(t*Math.PI/2):i.lt<0?Math.sin(t*Math.PI/2):(1-Math.cos(t*Math.PI))/2;break}throw"Unhandled ease type: "+r.toString()}t++}}s=~~s;const t=this.yt[e.ct];switch(e.ut){case 0:t.At=s-t.Pt;continue;case 1:t.Ct=s-t.Ft;continue;case 2:t.kt=s-t.Lt;continue;case 3:t.St=s-t.Rt;continue;case 4:t.Tt=s;continue;case 5:t.Wt=s;continue;case 6:t.Nt=s;continue;case 7:t.Ot=s;continue;case 8:t.jt=s,t.Yt=s;continue;case 9:t.Yt=s;continue;case 10:t.jt=s;continue;case 11:t.zt=s;continue;case 12:t._t=s;continue;case 13:t.Vt=s?-1:1;continue;case 14:t.Zt=s?-1:1;continue;default:throw"Unhandled modification type: "+e.ut}}}for(let t=0;t<this.vt;t++)this.yt[t].update(this);for(let t=0;t<this.vt;t++)this.li[t]=t,this.e[t]=this.yt[t].Rt+this.yt[t].St;for(let t=1;t<this.vt;t++){let i=this.li[t],s=this.e[t],h=t-1;for(;h>=0&&this.e[h]>s;)this.li[h+1]=this.li[h],this.e[h+1]=this.e[h],h--;this.li[h+1]=i,this.e[h+1]=s}}async load(t){let i=new e;this.reset(),await i.K(t),i.tt(),i.it();let s=i.Z(0);i.it(),this.vt=i.Z(0),this.yt=new Array(this.vt),this.li=new Int32Array(this.vt),this.e=new Int32Array(this.vt);for(let t=0;t<this.vt;t++)i.it(),this.yt[t]=new u,this.yt[t].Pt=i.Z(0),this.yt[t].Ft=i.Z(1),this.yt[t].Lt=i.Z(2),this.yt[t].Rt=i.Z(3),this.yt[t].Bt=i.Z(4),this.yt[t].Gt=i.Z(5),this.yt[t].Dt=i.Z(6),this.yt[t].Ut=i.Z(7),this.yt[t].Xt=i.Z(8),this.yt[t].qt=i.Z(9),this.yt[t].rotation=i.Z(10),this.yt[t].alpha=i.Z(11),this.yt[t].It=s>=2?i.Z(12):0;if(s>=1?(i.it(),this.ti=i.Z(0),this.hi=i.Z(1),this.ii=i.Z(2)):(this.ti=100,this.hi=360,this.ii=255),s>=3){i.it(),this.ui=i.Z(0),this.ci=new Array(this.ui);for(let t=0;t<this.ui;t++)i.it(),this.ci[t]=new f,this.ci[t].b=i.Z(0),this.ci[t].a=this.yt[this.ci[t].b],this.ci[t].c=i.Z(1),this.ci[t].d=i.Z(2),this.ci[t].e=i.Z(3),this.ci[t].f=i.Z(4),this.ci[t].ai=i.Z(5)}else this.ui=0;i.close()}gi(){return this.yt[0]}yi(){return this.ti}reset(){this.yt=void 0,this.li=void 0,this.e=void 0,this.ci=void 0}}const m=GIF;var w=t.n(m);class p{static vi=[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,2,2,3,3,3,3,3,3,3,2,3,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,2,2,3,3,3,3,3,3,3,3,3,3,2,2,3,3,3,3,3,2,3,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,3,3,3,2,2,2,2,2,2,3,3,3,3,3,3,3,2,2,3,2,3,3,2,2,3,2,3,2,3,3,2,2,3,2,2,3,3,3,3,3,3,2,3,2,3,2,2,2,2,2,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,2,2,2,2,2,2,2,2,3,3,3,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,3,3,2,3,3,3,3,2,2,3,2,2,2,2,2,3,3,3,2,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,2,3,2,3,3,3,3,3,2,3,3,3,3,3,2,3,2,2,3,3,2,3,3,3,3,2,2,2,3,3,3,3,2,3,3,3,3,3,1,3,3,2,2,3,3,2,3,2,2,2,3,3,3,2,3,2,3,3,3,3,3,3,2,2,2,2,2,2,3,3,2,2,2,2,2,3,3,2,3,2,2,3,3,2,3,2,2,2,2,3,3,3,3,3,3,3,3,2,2,2,3,3,2,2,3,2,2,2,3,3,2,2,3,3,2,2,3,2,2,2,2,2,2,2,2,3,3,2,2,2,3,2,2,2,2,3,3,2,3,2,2,3,3,3,3,3,3,2,2,3,2,3,2,2,2,3,2,2,2,2,2,3,2,3,2,2,3,3,3,2,2,2,3,3,2,2,2,2,3,2,2,3,2,2,2,2,2,3,2,2,2,3,2,2,3,3,2,2,2,2,2,3,2,2,3,3,2,2,2,2,3,2,2,2,2,2,2,2,3,2,3,3,3,2,3,2,2,2,2,2,3,3,3,3,2,2,2,2,3,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,3,3,3,3,3,2,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,3,2,2,2,2,3,3,2,2,2,2,2,2,2,2,2,2,2,3,2,2,3,2,2,3,3,2,2,3,3,3,3,3,2,2,2,2,2,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,3,3,3,2,2,2,2,2,2,2,2,3,2,2,3,2,3,3,2,2,2,3,3,3,2,2,2,3,3,2,2,1,2,3,3,2,2,2,2,2,2,2,2,3,2,2,2,2,2,3,2,2,2,2,2,3,2,2,3,2,2,2,2,2,3,3,2,2,2,2,2,3,2,2,3,3,2];static $i={656:[1,0],658:[2,0],659:[7,0],663:[4,0],664:[3,0],665:[9,0],669:[9,0],670:[2,0],675:[7,0],676:[6,0],685:[1,0],691:[10,0],697:[8,0],700:[1,0],706:[7,0],707:[9,0],713:[8,0],716:[1,0],717:[6,0]};xi;Mi;bi;_i;Ii;Pi;Ai;Fi;Ci;Li;ki=!1;Ri;Si;Bi;Gi;stopped=!0;Ti=0;Wi=0;Di=new Array(2);Ui=new Array(3);Ni=new Array(3);stop=!1;Oi=1e3/30;then=0;Xi;Yi(){if(i.h.canvas=document.getElementById("canvas"),this.bi=document.getElementById("animtype"),this.xi=document.getElementById("next"),this.Mi=document.getElementById("pause"),this._i=document.getElementById("unitid"),this.Ii=document.getElementById("range"),this.Pi=document.getElementById("downloadImg"),this.Ai=document.getElementById("downloadV"),this.Fi=document.getElementById("icons"),i.h.l=i.h.canvas.getContext("webgl2"),!i.h.l&&(console.warn("WebGL2 is not available, fallback to webgl"),i.h.l=i.h.canvas.getContext("webgl"),!i.h.l))throw alert("您的瀏覽器不支援WebGL2"),"";this.Xi=this.animate.bind(this);function t(t,s){const h=i.h.l.createShader(t);if(i.h.l.shaderSource(h,s),i.h.l.compileShader(h),!i.h.l.getShaderParameter(h,i.h.l.COMPILE_STATUS))throw alert(i.h.l.getShaderInfoLog(h)),"";return h}const h=i.h.l.createProgram();function e(){const t=i.h.canvas,s=i.h.l,h=t.clientWidth,e=t.clientHeight;t.width=h,t.height=e,i.h.I(0,h,e,0,-1,1),s.uniformMatrix4fv(i.h.v,!1,i.h.matrix),s.viewport(0,0,t.clientWidth,t.clientHeight),i.h.$=t.clientWidth/2,i.h.M=t.clientHeight/2+100}i.h.l.attachShader(h,t(i.h.l.VERTEX_SHADER,"\nattribute vec2 vertexPosition;\nattribute vec2 texturePosition;\nattribute float alphaC;\nuniform mat4 u_matrix;\n\nvarying float v_alpha;\nvarying vec2 vTexturePosition;\n\nvoid main(void) {\n\tgl_Position = u_matrix * vec4(vertexPosition, 0.0, 1.0);\n\tvTexturePosition = texturePosition;\n\tv_alpha = alphaC;\n}")),i.h.l.attachShader(h,t(i.h.l.FRAGMENT_SHADER,"\nprecision mediump float;\n\nuniform sampler2D sampler;\nvarying vec2 vTexturePosition;\nvarying float v_alpha;\n\nvoid main(void) {\n\tgl_FragColor = texture2D(sampler, vTexturePosition) * v_alpha;\n}")),i.h.l.linkProgram(h),i.h.l.useProgram(h),i.h.o=h,i.h.position=i.h.l.getAttribLocation(h,"vertexPosition"),i.h.m=i.h.l.getAttribLocation(h,"texturePosition"),i.h.v=i.h.l.getUniformLocation(h,"u_matrix"),i.h.u=i.h.l.createBuffer(),i.h.p=i.h.l.createBuffer(),i.h.g=i.h.l.getAttribLocation(h,"alphaC"),e(),window.onresize=e,s.h.H();for(let t=0;t<3;++t)this.Di[t]=new n;for(let t=0;t<3;++t)this.Ni[t]=new d;for(let t=0;t<3;++t){const i=this.Ui[t]=new Array(4);for(let t=0;t<4;++t)i[t]=new r}this._i.onchange=this.qi.bind(this);{const t=new URL(location.href).searchParams.get("id");if(t){const i=parseInt(t);isFinite(i)&&i&&(this._i.value=i.toString())}}this.qi({currentTarget:this._i});let a=this;this.Mi.onclick=function(){a.stopped?(a.stop=!1,a.stopped=!1,a.animate()):(a.Bi=NaN,a.stop=!0)},this.xi.onclick=function(){a.stopped&&(a.Ii.value=(++a.Gi).toString(),a.Hi())},this.Ii.oninput=function(){a.stopped&&(a.Gi=parseInt(a.Ii.value),a.Hi())},this.bi.oninput=function(){a.Gi=0,a.Hi(),a.Ti=a.bi?.selectedIndex,a.Ii.max=a.Ui[a.Wi][a.Ti].$t.toString()},this.Pi.onclick=function(){const t=s.h;t.W(),a.Hi(),t.D();const h=document.createElement("canvas"),e=h.getContext("2d");h.width=Math.max(t.R-t.k,100),h.height=Math.max(t.S-t.B,100),t.G=t.k,t.T=t.B,a.Hi(),e.drawImage(i.h.l.canvas,0,0),h.toBlob((function(t){const i=document.createElement("a"),s=window.URL.createObjectURL(t);i.href=s,i.download=`Cat No.${a.Bi}.png`,i.click()}))},this.Ai.onclick=function(){a.stop=!0,a.Gi=0;const t=i.h.l;let h=prompt("每禎延遲(毫秒)\n延遲 = 1000 / 禎率 = 1000 / 30 = 33.33...","33");if(!h)return;if(h=parseInt(h),!isFinite(h)||h<=0)return;let e=prompt("開始禎","0");if(!e)return;e=parseInt(e);const n=a.Ui[a.Wi][a.Ti].$t;if(!isFinite(e)||e<0||e>n)return;let o=prompt("結束禎",n.toString());if(!o)return;if(o=parseInt(o),!isFinite(o)||e>o)return;let r=prompt("精度(像素採樣間隔，越低品質越好，最低1)","10");if(!r)return;if(r=parseInt(r),!isFinite(r)||r<=0)return;const l=s.h;l.W();for(let t=e;t<=o;++t)a.Hi(),a.Gi=t;l.D();const c=document.createElement("canvas"),u=c.getContext("2d",{ji:!0});c.width=Math.max(l.R-l.k,100),c.height=Math.max(l.S-l.B,100),l.G=l.k,l.T=l.B,t.clearColor(0,0,0,1);const f=new(w())({quality:r,width:c.width,height:c.height});for(let i=e;i<=o;++i)a.Hi(),a.Gi=i,u.drawImage(t.canvas,0,0),f.frames.push({data:u.getImageData(0,0,c.width,c.height).data,delay:h,zi:!1,Vi:-1});t.clearColor(0,0,0,0),l.G=l.T=0;let d=a.Ii?.max;a.Ii.value="0",f.on("progress",(function(t){a.Ii.value=(~~(1e3*t)).toString()})),f.on("finished",(function(t){const i=document.createElement("a"),s=window.URL.createObjectURL(t);i.href=s,i.download="animation.gif",i.click(),a.Ii.value=d})),f.render(),s.h.j()};for(let t of this.Fi.children)t.onclick=function(t){const i=t.currentTarget;a.Wi=parseInt(i.getAttribute("data-i"));for(let t of a.Fi?.children)t.className=t==i?"active":"";a.Ii.max=a.Ui[a.Wi][a.Ti].$t.toString(),a.Ii.value="0",a.Gi=0,a.stopped&&a.Hi()};i.h.canvas.addEventListener("mousedown",(function(t){a.ki=!0})),i.h.canvas.addEventListener("mouseup",(function(t){a.ki=!1})),i.h.canvas.addEventListener("mousemove",(function(t){a.ki&&(i.h.$+=t.movementX,i.h.M+=t.movementY,a.stopped&&a.Hi())})),i.h.canvas.addEventListener("touchstart",(function(t){a.ki=!0,a.Ri=t.touches[0].clientX,a.Si=t.touches[0].clientY,t.preventDefault()})),i.h.canvas.addEventListener("touchend",(function(t){a.ki=!1,t.preventDefault()})),i.h.canvas.addEventListener("touchmove",(function(t){const{clientX:s,clientY:h}=t.changedTouches[0];i.h.$+=s-a.Ri,i.h.M+=h-a.Si,a.Ri=s,a.Si=h,a.stopped&&a.Hi(),t.preventDefault()})),(this.Ci=document.getElementById("color1")).oninput=function(){i.h.canvas.style.setProperty("background",`linear-gradient(${a.Ci.value},${a.Li.value})`,"important"),localStorage.setItem("color1",a.Ci.value),localStorage.setItem("color2",a.Li.value)},(this.Li=document.getElementById("color2")).oninput=function(){i.h.canvas.style.setProperty("background",`linear-gradient(${a.Ci.value},${a.Li.value})`,"important"),localStorage.setItem("color1",a.Ci.value),localStorage.setItem("color2",a.Li.value)};let o=localStorage.getItem("color1");if(o){let t=localStorage.getItem("color2");t&&(a.Ci.value=o,a.Li.value=t,i.h.canvas.style.setProperty("background",`linear-gradient(${o},${t})`,"important"))}document.getElementById("zoom").oninput=function(t){const s=t.currentTarget,h=parseInt(s.value)/100,e=i.h.canvas,n=i.h.l;let o=e.clientWidth,r=e.clientHeight;e.width=o,e.height=r,n.viewport(0,0,o,r),o*=h,r*=h,i.h.I(0,o,r,0,-1,1),n.uniformMatrix4fv(i.h.v,!1,i.h.matrix),i.h.$=o/2,i.h.M=(e.clientHeight/2+100)*h,a.stopped&&a.Hi()},document.getElementById("fps").oninput=function(t){const i=t.currentTarget;a.Oi=1e3/parseInt(i.value)}}Hi(){let t=new c;const h=this.Ni[this.Wi],e=this.Ti,n=this.Ui[this.Wi][e];this.Gi>n.$t&&(this.Gi=0),h.pi(n,this.Gi);h.fi(0).Mt().ei(h,h.fi(0).oi(),h.fi(0).ri(),t),s.h.j(),h.mi(i.h.$-t.x,i.h.M-t.y)}async qi(t){let i=parseInt(t.currentTarget.value);if(!isFinite(i))return;this.Bi=NaN,this.stop=!0;const s=new URL(location.href);s.searchParams.set("id",i.toString()),history.pushState({},"",s),await this.Zi(i),this.Bi=i,this.stopped&&(this.stopped=!1,this.stop=!1,this.Gi=0,this.animate())}animate(t){if(null!=t&&(this.Ii.value=this.Gi.toString()),this.stop){if(isNaN(this.Bi)){this.stopped=!0;let t=parseInt(this._i.value);if(!isFinite(t))return;this.Bi=t}else this.stop=!1,this.Gi=0,this.stopped=!1,this.animate();return}requestAnimationFrame(this.Xi);const i=performance.now(),s=i-this.then;s>this.Oi&&(this.then=i-s%this.Oi,this.Hi(),++this.Gi)}async Zi(t){if(this.Wi=0,t<0){-0==(t=-(t+1))&&(t=0);let s=i._(t);for(let t of this.Di)t.reset();let h=new Array;h.push(this.Di[0].load(`/data/enemy/${s}/${s}_e.png`,`/data/enemy/${s}/${s}_e.imgcut`,0));for(let t=0;t<4;++t)h.push(this.Ui[0][t].load(`/data/enemy/${s}/${s}_e0${t}.maanim`));const e=this.Ni[0];e.di(this.Di[0]),h.push(e.load(`/data/enemy/${s}/${s}_e.mamodel`)),await Promise.all(h),this.Ni[0].pi(),this.Ii.max=this.Ui[0][this.Ti].$t.toString();const n=this.Fi?.children;return n[0].style.display="none",n[1].style.display="none",void(n[2].style.display="none")}let s=i._(t);for(let t of this.Di)t.reset();const h=p.vi[t];let e=new Array;const n=p.$i[t.toString()]||[];for(let t=0;t<n.length;++t)n[t]=i._(n[t]);for(let t=0;t<h;++t){if(null!=n[t]){e.push(this.Di[t].load(`/data/img/m/${n[t]}/${n[t]}_m.png`,`/data/img/m/${n[t]}/${n[t]}_m.imgcut`,0));continue}const i="fcs"[t];e.push(this.Di[t].load(`/data/unit/${s}/${i}/${s}_${i}.png`,`/data/unit/${s}/${i}/${s}_${i}.imgcut`,0))}for(let t=0;t<h;++t){if(null!=n[t]){for(let i=0;i<4;++i)e.push(this.Ui[t][i].load(`/data/img/m/${n[t]}/${n[t]}_m0${i}.maanim`));continue}const i="fcs"[t];for(let h=0;h<4;++h)e.push(this.Ui[t][h].load(`/data/unit/${s}/${i}/${s}_${i}0${h}.maanim`))}for(let t=0;t<h;++t){const i=this.Ni[t];if(null!=n[t]){i.di(this.Di[t]),e.push(i.load(`/data/img/m/${n[t]}/${n[t]}_m.mamodel`));continue}const h="fcs"[t];i.di(this.Di[t]),e.push(i.load(`/data/unit/${s}/${h}/${s}_${h}.mamodel`))}await Promise.all(e);const a=this.Fi?.children;for(let t=0;t<3;++t){const i=a[t];if(t>=h)i.style.display="none";else if(i.style.display="block",null!=n[t])i.src=`/data/img/m/${n[t]}/uni${n[t]}_m00.png`;else{const h="fcs"[t];i.src=`/data/unit/${s}/${h}/uni${s}_${h}00.png`}i.className=t?"":"active"}for(let t of this.Ni)t.pi();this.Ii.max=this.Ui[0][this.Ti].$t.toString()}}(new p).Yi()})();